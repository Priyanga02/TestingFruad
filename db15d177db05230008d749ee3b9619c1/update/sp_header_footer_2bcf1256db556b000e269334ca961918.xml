<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_header_footer">
    <sp_header_footer action="INSERT_OR_UPDATE">
        <category>standard</category>
        <client_script><![CDATA[function ($rootScope, $scope, snRecordWatcher, spUtil, $location, $uibModal, cabrillo, $timeout, $window) {
	
	 //$scope.role=g_user.hasRoleExactly('gamification_admin');
	
	$scope.avatarProfile = {
		userID: $scope.user.sys_id,
		name: $scope.user.name,
		initials: $window.NOW.user_initials
	};
	
	if ($window.NOW.user_avatar) {
		$scope.avatarProfile.userImage = $window.NOW.user_avatar;
	}
	
	if (cabrillo.isNative())
		$scope.isViewNative = true;
	
	$scope.openPopUp = function() {
		var url = "$chat_support.do?queueID=" + $scope.data.connect_support_queue_id;
		var popup = window.open (url, "popup", "width=900, height=600");
	};
	
	$scope.openLogin = function () {
		$scope.modalInstance = $uibModal.open({
			templateUrl: 'modalLogin',
			scope: $scope
		});
	};
	
	var xsScreenSize = isXSScreenSize();
	$scope.showXSAvatar = isXSScreenSize();
	$scope.showAvatar = !isXSScreenSize();
	
	angular.element($window).on('resize', function () {
		if(xsScreenSize !== isXSScreenSize() && (!$scope.showXSAvatar || !$scope.showAvatar)){
			$scope.showXSAvatar = true;
			$scope.showAvatar = true;
		}
	});
	
	
	function isXSScreenSize() {
		return $window.matchMedia('(max-width: 767px)').matches;
	}
	
	$rootScope.$on('sp.avatar_changed', function() {
		$scope.userID = "";
		$timeout(function(){
			$scope.userID = $scope.user.sys_id;
		});
	});
	
	$scope.isHomepage = function() {
		if (!$scope.page.id)
			return true;
		
		if ($scope.page.id == $scope.portal.homepage_dv)
			return true;
		
		return false;
	};
	
// 	function($uibModal, $scope) {
// 		alert('test');
		//$scope.favVisible = true;
		var c = this;
		c.openModal = function() {
		
			c.modalInstance = $uibModal.open({
				templateUrl: 'modalTemplate',
				scope: $scope
			});
		};
		c.closeModal = function() {

			c.modalInstance.close();
		};
		
	
}


]]></client_script>
        <controller_as>c</controller_as>
        <css>.navbar {
  font-family: 'Roboto Condensed', sans-serif;
  transition: 250ms opacity ease-in-out;
  -webkit-transition: 250ms opacity ease-in-out;
  border: 0;
  border-bottom: 4px solid #061838;
  background-color:#061838;

}

.navbar-fade {
  opacity: 0.4;
}
.navbar-inverse .navbar-nav &gt; .open &gt; a
{
  background-color:#031027;
}


.textcolor{
  color: #F0F0F0;
}

.navbar-inverse .navbar-toggle {
  border-color: #061838;
}

header[role="banner"],
.nav &gt; li &gt; a {
  max-height: 60px;
}

@media screen and (max-width: 768px){
  .nav &gt; li &gt; a {
    padding-right: 0.5rem;
    padding-left: 0.5rem;
  }
}

.navbar-brand {
  max-height: 60px;
  padding: 0;
  padding-bottom: 0.5rem;
}

.navbar-brand img, .navbar-brand span {
  margin-left: $sp-logo-margin-x;
  margin-right: $sp-logo-margin-x;
  margin-top: $sp-logo-margin-y;
  margin-bottom: $sp-logo-margin-y;
  display: block;
  max-height: $sp-logo-max-height;
  max-width: $sp-logo-max-width;
  position: relative;
  top: 50%;
  -webkit-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  transform: translateY(-50%);
}
.breadcrumb-container {
  background-color: $panel-bg;
}

/* for mobile app */
.navbar-inverse.is-native {
  background-color: #061838;
}

nav{
 margin-bottom: 0px;
 border-radius: 0px;
}

.navbar-collapse{
padding-right: 0px;
}

.navbar-nav {
margin: 0px;
}

// PRB711244: Dropdown menu is scrollable when too many items
.scrollable-dropdown {
  max-height: 80vh;
  overflow: auto;
  height: auto;
}

.is-native {
 .scrollable-dropdown {
  max-height: 100vh;
  overflow: scroll;
  height: auto;
	}
}


/* PRB923910: Fix for Service Portal - Header Poorly Aligned in Safari */
@media screen and (min-width: 768px) {
  .navbar-collapse {
    display: flex !important;
  }
}

.ep-favorite-btn{
      position: fixed;
    right: 0;
    top: 250px;
    z-index: 15;
    transform: rotate(90deg) translateY(-55px);
    padding: 10px 18px;
    font-size: 1.1em;
    color: #fff;
    border: 0;
    background-color: $brand-primary;
}


@keyframes slideInRightFD{
  0% {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    opacity: 0
    visibility: visible;
}
100% {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    opacity: 1;
}
}

@media screen and (max-width: 500px) {
  .ep-favorite-btn{
    transform: none;
    top: 60px;
  
  }
  .ep-favorite-btn span:first-child{
    display: none;
  }
  
  #mySidenav a {
    position: absolute;
    left: -80px;
    transition: 0.3s;
    padding: 15px;
    width: 100px;
    text-decoration: none;
    font-size: 20px;
    color: white;
    border-radius: 0 5px 5px 0;
}

#mySidenav a:hover {
    left: 0;
}
#about {
    top: 20px;
    background-color: #061838;
}
  
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function(scope, element) {
	$(document).keyup(function(event) {
		if (event.which == 9) { //tab key handler + arrow keys
			if ($(event.target).parents(".dropdown-menu").length == 0) { //if we are NOT inside a dropdown...
				//close the dropdowns
				$(".dropdown").removeClass("open");
				$("[data-toggle='dropdown']").attr("aria-expanded", "false");
			}
		}
	});
	
	$(element).on('click.nav','.navbar-collapse.in',function(e) {
		var target = $(e.target);
		if (target.is('a')) {
			if (target.hasClass('sp-menu-has-items'))
				return; // menu item has a submenu, so just toggle it
			
			// collapse mobile nav if clicked an anchor
			$(this).removeClass('in').addClass('collapse');
			return;
		}

		if (target.parent().hasClass("toggle-dropdown")) {
			// collapse mobile nav if parent has toggle-dropdown class
			$(this).removeClass('in').addClass('collapse');
			return;
		}

		// if neither target nor parent is an anchor, do nothing
		if (!target.parent().is('a'))
			return;

		// collapse mobile nav if target is part of a submenu
		if (target.parents("ul.dropdown-menu").length > 0)
			$(this).removeClass('in').addClass('collapse');
	});
}]]></link>
        <name>Gamification Stock Header</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[// Defines the support queue ID that will be linked to by the Live Chat link in header
data.connect_support_queue_id = $sp.getValue('sp_chat_queue');
//data.role=gs.getSession().getRoles().includes('gamification_admin');
data.role= (gs.hasRole('gamification_admin')||gs.hasRole('itil'));
//data.role=true;
data.login_page = $sp.getValue('login_page');
data.profileBtnMsg = gs.getMessage("User options");
var menu = $sp.getValue("sp_rectangle_menu");
data.menu = $sp.getWidgetFromInstance(menu);
if (data.menu && data.menu.data) {
	data.menu.data.replace = true;
	// Hide login if menu already has link to login
	data.hasLogin = false;
	if (data.menu.data.menu.items) {
		for(var i in data.menu.data.menu.items) {
			var item = data.menu.data.menu.items[i];
			if (item.type == 'page' && item.sp_page == data.login_page)
				data.hasLogin = true;
		}
	}
}

data.loginWidget = $sp.getWidgetFromInstance('login-modal');


var gr = new GlideRecord('u_esmcafe_gamification_table');
gr.addQuery('u_user',gs.getUserID());
gr.query();
if(gr.next()){
data.points = gr.getDisplayValue('u_points');
data.level = gr.getDisplayValue('u_level');
}

var gr1 = new GlideRecord('u_gamification_level');

switch(data.level.toString()) {

case 'Level 1':

gr1.addQuery('u_level','level 2');
gr1.query();
if(gr1.next()){

data.attain = gr1.getDisplayValue('u_point');
data.takediff = data.attain-data.points;

}
		break;
case 'Level 2':

gr1.addQuery('u_level','level 3');
gr1.query();
if(gr1.next()){

data.attain = gr1.getDisplayValue('u_point');
data.takediff = data.attain-data.points;

}
		break;
case 'Level 3':

gr1.addQuery('u_level','level 4');
gr1.query();
if(gr1.next()){

data.attain = gr1.getDisplayValue('u_point');
data.takediff = data.attain-data.points;

}
	
else{
data.takediff = '100';
}
			break;
default :
data.takediff = '100';
}]]></script>
        <servicenow>false</servicenow>
        <static>false</static>
        <sys_class_name>sp_header_footer</sys_class_name>
        <sys_created_by>admin.vikas</sys_created_by>
        <sys_created_on>2018-10-24 09:19:10</sys_created_on>
        <sys_id>2bcf1256db556b000e269334ca961918</sys_id>
        <sys_mod_count>86</sys_mod_count>
        <sys_name>Gamification Stock Header</sys_name>
        <sys_package display_value="EsmCafe Gamification" source="db15d177db05230008d749ee3b9619c1">db15d177db05230008d749ee3b9619c1</sys_package>
        <sys_policy/>
        <sys_scope display_value="EsmCafe Gamification">db15d177db05230008d749ee3b9619c1</sys_scope>
        <sys_update_name>sp_header_footer_2bcf1256db556b000e269334ca961918</sys_update_name>
        <sys_updated_by>ujwal.kumar@infosys.com</sys_updated_by>
        <sys_updated_on>2019-05-31 09:27:58</sys_updated_on>
        <template><![CDATA[<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
<div>
  <nav class="navbar-inverse" ng-class="::{'navbar':!isViewNative, 'is-native': isViewNative}"
       role="navigation">
    <div ng-show="::!isViewNative" class="navbar-header">
      <a class="navbar-brand textcolor" ng-if="::!portal.logo" href="?id={{::portal.homepage_dv}}"><span>{{::portal.title}}</span></a>
      <a class="navbar-brand navbar-brand-logo" ng-if="::portal.logo" href="?id={{::portal.homepage_dv}}" aria-label="${Go to homepage}">
        <img ng-src="{{::portal.logo}}" title="ServiceNow" role="presentation" alt="${Portal Logo}" />
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sp-nav-bar">
        <span class="sr-only">${Toggle navigation}</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>
    
    <div sp-navbar-toggle="" class="collapse navbar-collapse navbar-right scrollable-dropdown" id="sp-nav-bar">
      <!-- Include The Menu -->
      
        <ul class="nav navbar-nav" ng-if="data.role" >
        <li>
          <a style="color:#FFFFFF" class="pull-right" ng-href="?id=list&table=u_gamification_level&filter=">Levels</a>
        </li>
        <li><a style="color:#FFFFFF" class="pull-right" ng-href="?id=list&table=u_gamification_badge&filter=">Badges</a></li>
        <li><a style="color:#FFFFFF" class="pull-right" ng-href="?id=list&table=u_gamification_criteria&filter=">Criteria</a></li>
       </ul>
      
      <sp-widget widget="::data.menu"></sp-widget>
      <ul ng-if="::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)" class="nav navbar-nav" role="presentation">
        <li role="presentation"><a href ng-click="::openLogin()">${Login}</a></li>
      </ul>
      <ul ng-if="::user.logged_in" class="nav navbar-nav" role="menubar">
        <!-- chat, avatar, and logout -->
        <li ng-if="::data.connect_support_queue_id" role="presentation"><a href ng-click="openPopUp()" role="menuitem">${Live Chat}</a></li>
        <li ng-if="showAvatar" class="hidden-xs dropdown" role="presentation">
          <a href class="toggle-dropdown" data-toggle="dropdown" aria-expanded="false" title="{{::data.profileBtnMsg}}" aria-label="{{::data.profileBtnMsg}}: {{::user.name}}" id="profile-dropdown"  role="menuitem" aria-haspopup="true">
             <span class="navbar-avatar" aria-hidden="true"><sn-avatar class="avatar-small-medium" primary="avatarProfile" /></span>
             <span class="visible-lg-inline" style="color:#FFFFFF">{{::user.name}}</span>
          </a>
          <ul class="dropdown-menu" role="menu" aria-label="{{::data.profileBtnMsg}}">
            <li role="presentation"><a tabindex="-1" ng-href="?id=user_profile&sys_id={{::user.sys_id}}" role="menuitem">${Profile}</a></li>
            <li ng-if="data.role" role="presentation"><a tabindex="-1" ng-href="?id=esm_gamification_manager" role="menuitem">Manager's View</a></li>
            <li ng-if="::!isViewNative" role="presentation"><a tabindex="-1" href="{{::portal.logoutUrl}}" role="menuitem">${Logout}</a></li>
          </ul>
        </li>
        <li ng-if="showXSAvatar" class="visible-xs-block" role="presentation"><a role="menuitem" ng-href="?id=user_profile&sys_id={{::user.sys_id}}">
          <span class="navbar-avatar"><sn-avatar class="avatar-small-medium" primary="avatarProfile" /></span>{{::user.name}}</a>
        </li>
        <li ng-if="::!isViewNative" class="visible-xs-block" role="presentation"><a role="menuitem" href="{{::portal.logoutUrl}}">${Logout}</a></li>
      </ul>
    </div>
  </nav>
  <!-- favourite button--
  <button id="epFavBtn" class="ep-favorite-btn"  ng-click="showFavorites()">
    <span >${My Targets}</span> <span><i class="fa fa-road" aria-hidden="true"></i></span>
  </button>
  -->
 <!--<div>
	<button id="epFavBtn" class="ep-favorite-btn" ng-click="c.openModal()"><span >${My Targets}</span> <span><i class="fa fa-road" aria-hidden="true"></i></span></button>
</div>-->
 
<!--<script type="text/ng-template" id="modalTemplate">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">My Targets</h4>
  		</div>
		<div class="panel-body wrapper-xl">
		<span style="font-size:250%">	Your goal is to attain <span style="background-color:#FFFF00">{{data.takediff}}</span> points to reach next level! </span>
  		</div>
		<div class="panel-footer text-right">
			<button class="btn btn-primary" ng-click="c.closeModal()">${Close}</button>
		</div>
	</div>
</script>-->

</div>]]></template>
    </sp_header_footer>
</record_update>
